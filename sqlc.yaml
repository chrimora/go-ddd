version: "2"

common_overrides: &common_overrides
  sql_package: "pgx/v5"
  emit_empty_slices: true
  emit_pointers_for_null_types: true
  overrides:
    - db_type: "uuid"
      nullable: false
      go_type:
        import: "github.com/google/uuid"
        type: "UUID"
    - db_type: "uuid"
      nullable: true
      go_type:
        import: "github.com/google/uuid"
        type: "UUID"
        pointer: true
    - db_type: "timestamptz"
      nullable: false
      go_type:
        import: "time"
        type: "Time"
    - db_type: "timestamptz"
      nullable: true
      go_type:
        import: "time"
        type: "Time"
        pointer: true

sql:
  - name: "outbox"
    engine: "postgresql"
    schema: "./internal/infrastructure/sql/outbox/schema.sql"
    queries: "./internal/infrastructure/sql/outbox/queries.sql"
    gen:
      go:
        package: "outboxdb"
        out: "./internal/infrastructure/sql/codegen/outbox"
        <<: *common_overrides
  - name: "user"
    engine: "postgresql"
    schema: "./internal/infrastructure/sql/user/schema.sql"
    queries: "./internal/infrastructure/sql/user/queries.sql"
    gen:
      go:
        package: "userdb"
        out: "./internal/infrastructure/sql/codegen/user"
        <<: *common_overrides
